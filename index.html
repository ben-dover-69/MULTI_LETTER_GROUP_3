
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multipurpose Letter</title>

<!-- GOOGLE FONTS -->
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Pacifico&family=Quicksand:wght@400;600&family=Comic+Neue:wght@300;700&family=Dancing+Script:wght@400;700&family=Abril+Fatface&display=swap" rel="stylesheet">

<!-- EMAILJS -->
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script>
(function(){
  emailjs.init("WodD_TueS-UN6i-Va");
})();
</script>

<style>
/* ================= BASE ================= */
*{box-sizing:border-box}
body{
  margin:0;
  min-height:100vh;
  font-family:'Quicksand',sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:20px;
  transition:0.5s;
}

/* ================= BACKGROUNDS ================= */
body.love{background:#800020}
body.formal{background:#1f3b4d}
body.informal{background:#fff0d6}
body.birthday{background:#ff8acb}
body.invitation{background:#6a5acd}

/* ================= LAYOUT ================= */
.container{max-width:900px;width:100%}

h1{
  text-align:center;
  margin-bottom:15px;
  font-size:3em;
}

.controls{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  justify-content:center;
  margin-bottom:15px;
}

input, textarea, select, button{
  padding:10px;
  border-radius:8px;
  border:none;
  font-family:inherit;
  font-size:1em;
}

textarea{
  resize:none;
  height:150px;
  width:100%;
}

/* ================= LETTER ================= */
.postcard{
  background:linear-gradient(180deg,#fff,#f3f3f3);
  padding:40px;
  border-radius:18px;
  box-shadow:
    0 18px 40px rgba(0,0,0,.35),
    inset 0 0 30px rgba(0,0,0,.05);
  animation:letterIn .8s ease;
}

@keyframes letterIn{
  from{opacity:0;transform:translateY(30px)}
  to{opacity:1;transform:translateY(0)}
}

.postcard::before{
  content:'';
  display:block;
  width:60px;
  height:4px;
  background:rgba(0,0,0,.2);
  border-radius:5px;
  margin-bottom:15px;
}

.date{
  font-size:.9em;
  opacity:.7;
  margin-bottom:10px;
}

.message{
  margin:25px 0;
  line-height:1.8;
  white-space:pre-wrap;
}

.signature{
  margin-top:30px;
  font-family:'Dancing Script',cursive;
  font-size:1.5em;
}

/* ================= TITLES ================= */
body.love h1{font-family:'Pacifico',cursive;color:#fff}
body.formal h1{font-family:'Playfair Display',serif;color:#fff}
body.informal h1{font-family:'Comic Neue',sans-serif;color:#a85b00}
body.birthday h1{font-family:'Pacifico',cursive;color:#d60073}
body.invitation h1{font-family:'Abril Fatface',serif;color:#3a0088}

/* ================= BUTTONS ================= */
#saveDraft,#sendBtn{
  background:linear-gradient(135deg,#ff4d6d,#ff758f);
  color:white;
  cursor:pointer;
  font-weight:bold;
  transition:.3s;
}

#saveDraft:hover,#sendBtn:hover{
  transform:translateY(-2px);
  box-shadow:0 6px 20px rgba(0,0,0,.3);
}

/* ================= MUSIC ================= */
#musicBtn{
  width:50px;height:50px;
  border-radius:50%;
  background:#ff9dbc;
  color:white;
  font-size:1.2em;
  cursor:pointer;
}
</style>
</head>

<body class="love">

<div class="container">

<h1 id="title">Love Letter</h1>

<div class="controls">
  <select id="format">
    <option value="love">Love Letter</option>
    <option value="formal">Formal Letter</option>
    <option value="informal">Informal Letter</option>
    <option value="birthday">Birthday Letter</option>
    <option value="invitation">Invitation Letter</option>
  </select>

  <button id="musicBtn">â–¶</button>
</div>

<div class="postcard" id="letterBox">
  <div class="date">Date: <span id="date"></span></div>

  <p>Dear <input id="recipient" placeholder="Recipient"></p>

  <textarea id="message" placeholder="Write your message..."></textarea>

  <p>Sincerely,</p>
  <input id="sender" placeholder="Anonymous">
</div>

<div class="controls">
  <input type="email" id="email" placeholder="Recipient Email">
  <button id="saveDraft">Save Draft</button>
  <button id="sendBtn">Send</button>
</div>

</div>

<audio id="bgMusic" loop></audio>

<script>
/* ===== DATE ===== */
document.getElementById("date").innerText =
  new Date().toLocaleDateString(undefined,{year:"numeric",month:"long",day:"numeric"});

/* ===== MUSIC ===== */
const bgMusic=document.getElementById("bgMusic");
const musicBtn=document.getElementById("musicBtn");
let playing=false;

const music={
  love:"kuped.mp3",
  formal:"peynknwite.mp3",
  informal:"arizonab.mp3",
  birthday:"bdaysmegs.mp3",
  invitation:"when.mp3"
};

musicBtn.onclick=()=>{
  if(!playing){
    bgMusic.play().catch(()=>{});
    musicBtn.innerText="â¸";
  }else{
    bgMusic.pause();
    musicBtn.innerText="â–¶";
  }
  playing=!playing;
};

/* ===== SWITCH LETTER ===== */
const format=document.getElementById("format");
const title=document.getElementById("title");

format.onchange=()=>{
  document.body.className=format.value;
  title.innerText=format.options[format.selectedIndex].text;
  bgMusic.src=music[format.value];
  if(playing)bgMusic.play();
};

/* ===== SAVE DRAFT ===== */
document.getElementById("saveDraft").onclick=()=>{
  localStorage.setItem("draft",JSON.stringify({
    r:recipient.value,
    s:sender.value,
    m:message.value,
    t:format.value
  }));
  alert("Draft saved");
};

/* ===== SEND ===== */
document.getElementById("sendBtn").onclick=()=>{
  if(!email.value){
    alert("Enter recipient email");
    return;
  }

  const data={
    title:title.innerText,
    recipient:recipient.value,
    sender:sender.value||"Anonymous",
    message:message.value,
    date:document.getElementById("date").innerText,
    type:format.value,
    font:getComputedStyle(letterBox).fontFamily,
    color:getComputedStyle(letterBox).color,
    size:getComputedStyle(letterBox).fontSize
  };

  const encoded=btoa(JSON.stringify(data));
  const link=`https://ben-dover-69.github.io/MULTI_LETTER_GROUP3/view.html?data=${encoded}`;

  emailjs.send("service_blwhkvs","template_ka72mdg",{
    email:email.value,
    view_link:link
  }).then(()=>{
    alert("Letter sent successfully ðŸ’Œ");
  }).catch(()=>{
    alert("Failed to send letter");
  });
};
</script>

</body>
</html>